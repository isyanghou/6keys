---
title: "06-1_PWC ç›¸ä½æ‹“æ’²ç’°æµ Î²â‚(ä¸Š)"
date: 2025-06-22
language: zh-TW
encoding: UTF-8
---
# 06-1 PWCï¼šç›¸ä½æ‹“æ’²ç’°æµ Î²â‚ï¼ˆä¸Šï¼‰

## ğŸ¯ Purpose â€” ç†è«–å‹•æ©Ÿèˆ‡æ–‡ç»

### ç†è«–èƒŒæ™¯

1. **å¾åŒæ­¥åˆ°ç’°æµ**  
   è‡¨ç•Œè…¦ä¸åƒ…é—œä¹å°–å³°åŒæ­¥ï¼Œé‚„æ¶‰åŠ**ç›¸ä½ç©ºé–“çš„é€£é€šæ€§èˆ‡ç’°æµ**ã€‚TDA ç ”ç©¶é¡¯ç¤ºï¼Œæ¸…é†’ EEG ç›¸ä½é»é›²çš„ç¬¬ä¸€è²è’‚æ•¸ $\beta_1$ åœ¨ 2â€“6 å€é–“ç·©æ…¢æ¼‚ç§»ï¼›è€Œæ·±éº»é†‰æ™‚å‰‡é©Ÿé™è‡³ $\beta_1 = 0$ï¼Œè¡¨ç¤ºç›¸ä½ç’°æµå´©æ½°ã€æ‹“æ’²è£‚è§£ã€‚

2. **è…¦ç¯€å¾‹äº¤äº’å¾ªç’°**  
   $\theta$â€“$\gamma$ åµŒå¥—èˆ‡ $\beta$â€“$\alpha$ CFC ç­‰è…¦ç¯€å¾‹äº¤äº’æ©Ÿåˆ¶ï¼Œéœ€ä»°è³´ç©©å®šçš„ç›¸ä½ç’°æµç®¡é“ã€‚ç•¶æ‹“æ’²ç’°æµæ¶ˆå¤±æ™‚ï¼Œå‚³çµ± CFC æŒ‡æ¨™ï¼ˆMI, PLVï¼‰äº¦æœƒåŒæ­¥å´©è§£ã€‚

3. **ç ”ç©¶ç¼ºå£**  
   ç¾è¡Œå·¥ä½œå¤šä½¿ç”¨å¹³å‡ PLV ç­‰æŒ‡æ¨™ï¼Œä½†é®®å°‘æœ‰äººå¾**é«˜ç¶­ç›¸ä½é»é›²çš„æ‹“æ’²çµæ§‹**ä¾†è¿½è¹¤æ™‚è®Šé€£é€šåº¦ã€‚å› æ­¤ï¼Œæˆ‘å€‘æå‡ºã€ŒPhaseâ€“Winding Circulation (PWC)ã€æ¨¡çµ„ï¼Œå°‡ $\beta_1$ ä½œç‚ºæ ¸å¿ƒæ‹“æ’²é‡ï¼Œç´å…¥å…­é‘°æ¶æ§‹ä¸¦å°æ‡‰ç„¡é‡ç¶±åŒ–åº§æ¨™ $\zeta_5$ã€‚
### ğŸ”¬ æ ¸å¿ƒå‡èªª

**ç•¶ç›¸ä½é»é›²ç¶­æŒ 2â€“6 æ¢ä¸€è‡´ç’°æµè·¯å¾‘ï¼ˆ$\beta_1 \in [2,6]$ï¼‰ï¼Œè…¦ç¶²æ ¼å¯åœ¨ä¸éåº¦åŒæ­¥çš„æƒ…æ³ä¸‹æ”¯æŒè·¨é »è€¦åˆèˆ‡è¨Šæ¯è¿´åœˆï¼Œæ­¤æ™‚ $\zeta_5$ ä¿æŒ $|\zeta_5| \leq 1$ ä¸¦å”åŠ© $D_w$ ç•™æ–¼ CTM ç®¡é“å…§ã€‚ä¸€æ—¦ $\beta_1$ è½è‡³ 0 æˆ–çˆ†å‡ >10ï¼Œæ‹“æ’²ç’°æµå´©æ½°æˆ–ç“¦è§£ï¼Œ$D_w$ éš¨å³ä¸Šå‡ä¸¦å°å‘æ„è­˜å¤±ç©©ã€‚**

---
## ğŸ“ Formulation â€” æ ¸å¿ƒæ–¹ç¨‹

### 6.1 ç›¸ä½é‡å»ºèˆ‡é»é›²

å°æ¯å° $\phi_k(t) = \arg(\mathcal{H}[x_k(t)])$ï¼ˆHilbert è§£æç›¸ä½ï¼‰ï¼Œçµ„æˆ $d$ ç¶­ç›¸ä½å‘é‡ $\boldsymbol{\phi}(t) \in \mathbb{T}^d$ã€‚

ä»¥åµŒå…¥çª— $\Delta t = 100$ ms æ»‘å‹•æŠ½æ¨£ç²å¾—é»é›²ï¼š

$$
\mathcal{P}(t) = \{\boldsymbol{\phi}(t - \tau_j)\}_{j=1}^{m}
$$

æ¡ç’°æµçª— $m = 200$ é»ã€‚

### 6.2 å»ºæ§‹ Vietorisâ€“Rips è¤‡å½¢

ç›¸ä½è·é›¢å®šç¾©ç‚ºï¼š

$$
d_{\text{wrap}}(\phi_i, \phi_j) = \min_{k \in \mathbb{Z}} \lVert \boldsymbol{\phi}_i - \boldsymbol{\phi}_j + 2\pi k \rVert_2
$$

è¨­åŠå¾‘ $\epsilon = 0.4$ï¼Œå¾— VR è¤‡å½¢ $\text{VR}_\epsilon(\mathcal{P})$ï¼›é€é Ripser GPU æ¼”ç®—æ³•æ±‚å¾—æŒçºŒåŒèª¿æ¢ $\beta_1(t)$ã€‚

### 6.3 PWC æŒ‡æ¨™èˆ‡äºŒå€¼åˆ¤æº–

å®šç¾©æ¨™æº–åŒ–æŒ‡æ¨™ï¼š

$$
\beta_1^{\text{norm}}(t) = \frac{\beta_1(t) - \beta_1^\ast}{\varepsilon_5}, \quad \zeta_5(t) = \beta_1^{\text{norm}}(t)
$$

PWC äºŒå€¼åˆ¤æº–ç‚ºï¼š

$$
C_{\text{PWC}} =
\begin{cases}
1, & 2 \leq \beta_1(t) \leq 6 \text{ ä¸” } |\dot{\beta}_1| \leq 0.2 \text{ æŒçºŒ } \tau_C\; (100\text{ ms}) \\
0, & \text{å¦å‰‡}
\end{cases} \tag{6.1}
$$

å…¶ä¸­ $\beta_1^\ast = 4$ï¼Œ$\varepsilon_5 = 1.5$ ç‚ºåŸºæ–¼æ¸…é†’åŸºç·šçš„ä¼°è¨ˆã€‚

### 6.4 ç„¡é‡ç¶±åŒ–è€¦åˆè‡³ $D_w$

$$
D_w^2 = w_5\,\zeta_5^{2} + \sum_{i \neq 5} w_i\,\zeta_i^{2} \tag{6.2}
$$

è‹¥ $C_{\text{PWC}} = 0$ï¼ˆç’°æµé€šé“å¡Œé™·æˆ–ç¢è£‚ï¼‰ï¼Œå‰‡ $|\zeta_5|$ å¢å¤§ï¼Œä½¿ $D_w$ æ˜“ç ´ $\theta_c$ã€‚æ­¤ç¾è±¡å¸¸è¦‹æ–¼æ·±ç¡ K-complex æˆ–ä¸™æ³Šé…š burstâ€“suppression å‰å…†éšæ®µã€‚

---
## ğŸ’» Implementation â€” è¨ˆç®—æµç¨‹èˆ‡æ¼”ç®—æ³•

### æ ¸å¿ƒæ¼”ç®—æ³•æ¶æ§‹(æ¥ä¸‹é )

```python
# PWC æ‹“æ’²åˆ†ææ ¸å¿ƒæµç¨‹
from sixkeys import PWC, load_demo
import numpy as np
from ripser import ripser
from scipy.signal import hilbert

class PWCAnalyzer:
    def __init__(self, data, fs=1000, embed_win=0.1, epsilon=0.4):
        self.data = data
        self.fs = fs
        self.embed_win = int(embed_win * fs)  # 100ms çª—å£
        self.epsilon = epsilon
        self.beta1_target = 4
        self.epsilon5 = 1.5
    
    def extract_phases(self):
        """æå–å¤šé€šé“ Hilbert ç›¸ä½"""
        phases = np.zeros_like(self.data)
        for ch in range(self.data.shape[1]):
            analytic = hilbert(self.data[:, ch])
            phases[:, ch] = np.angle(analytic)
        return phases
    
    def sliding_point_cloud(self, phases):
        """æ»‘å‹•çª—å£æ§‹å»ºç›¸ä½é»é›²"""
        n_samples, n_channels = phases.shape
        point_clouds = []
        
        for t in range(self.embed_win, n_samples):
            # æå–æ™‚é–“çª—å…§çš„ç›¸ä½å‘é‡
            window_phases = phases[t-self.embed_win:t, :]
            point_clouds.append(window_phases)
        
        return point_clouds
    
    def compute_betti1(self, point_cloud):
        """è¨ˆç®—ç¬¬ä¸€è²è’‚æ•¸"""
        # è¨ˆç®—ç›¸ä½è·é›¢çŸ©é™£ï¼ˆè€ƒæ…®é€±æœŸæ€§ï¼‰
        distances = self._phase_distance_matrix(point_cloud)
        
        # ä½¿ç”¨ Ripser è¨ˆç®—æŒçºŒåŒèª¿
        result = ripser(distances, metric='precomputed', maxdim=1)
        
        # æå– Î²â‚ï¼ˆä¸€ç¶­æ´çš„æ•¸é‡ï¼‰
        h1_bars = result['dgms'][1]
        beta1 = len(h1_bars[h1_bars[:, 1] - h1_bars[:, 0] > 0.1])
        
        return beta1
    
    def _phase_distance_matrix(self, phases):
        """è¨ˆç®—ç›¸ä½é»é–“çš„åŒ…è£¹è·é›¢"""
        n_points = len(phases)
        distances = np.zeros((n_points, n_points))
        
        for i in range(n_points):
            for j in range(i+1, n_points):
                # è¨ˆç®—åŒ…è£¹ç›¸ä½è·é›¢
                diff = phases[i] - phases[j]
                wrapped_diff = np.angle(np.exp(1j * diff))
                distances[i, j] = distances[j, i] = np.linalg.norm(wrapped_diff)
        
        return distances
    
    def pwc_criterion(self, beta1_series):
        """è¨ˆç®— PWC åˆ¤æº–å‡½æ•¸"""
        criteria = np.zeros(len(beta1_series))
        
        for t in range(len(beta1_series)):
            # æª¢æŸ¥ Î²â‚ ç¯„åœ
            in_range = 2 <= beta1_series[t] <= 6
            
            # æª¢æŸ¥è®ŠåŒ–ç‡ï¼ˆå¦‚æœæœ‰è¶³å¤ çš„æ­·å²æ•¸æ“šï¼‰
            if t > 0:
                rate_stable = abs(beta1_series[t] - beta1_series[t-1]) <= 0.2
            else:
                rate_stable = True
            
            criteria[t] = 1 if (in_range and rate_stable) else 0
        
        return criteria
    
    def normalize_zeta5(self, beta1_series):
        """è¨ˆç®—æ¨™æº–åŒ– Î¶â‚…"""
        return (beta1_series - self.beta1_target) / self.epsilon5
```

### ğŸ”§ åƒæ•¸è¨­å®šæŒ‡å¼•

| åƒæ•¸             | å»ºè­°å€¼     | èªªæ˜                                 |
|------------------|------------|--------------------------------------|
| **åµŒå…¥çª—å£**     | 100 ms     | å¹³è¡¡æ™‚é–“è§£æåº¦èˆ‡æ‹“æ’²ç©©å®šæ€§           |
| **VR åŠå¾‘**      | 0.4        | åŸºæ–¼ç›¸ä½ç©ºé–“å…¸å‹è·é›¢å°ºåº¦             |
| **ç›®æ¨™ $\beta_1$** | 4          | æ¸…é†’ç‹€æ…‹çš„å…¸å‹ç’°æµæ•¸é‡               |
| **å®¹å¿åº¦ $\varepsilon_5$** | 1.5      | å…è¨±çš„ $\beta_1$ æ³¢å‹•ç¯„åœ           |
| **ç©©å®šæ€§é–¾å€¼**   | 0.2        | $\beta_1$ è®ŠåŒ–ç‡çš„ç©©å®šæ€§è¦æ±‚         |

### ğŸš€ è¨ˆç®—å„ªåŒ–ç­–ç•¥

1. **GPU åŠ é€Ÿ**ï¼šä½¿ç”¨ Ripser++ æˆ– GUDHI GPU ç‰ˆæœ¬
2. **ä¸¦è¡Œè™•ç†**ï¼šå¤šç·šç¨‹è™•ç†ä¸åŒæ™‚é–“çª—å£
3. **è¨˜æ†¶é«”ç®¡ç†**ï¼šæ»‘å‹•çª—å£é¿å…é‡è¤‡è¨ˆç®—
4. **è¿‘ä¼¼ç®—æ³•**ï¼šå¤§è¦æ¨¡æ•¸æ“šæ™‚ä½¿ç”¨ landmark æ¡æ¨£

---
## ğŸ”— èˆ‡ CTM ç®¡é“çš„è€¦åˆé—œä¿‚

### æ‹“æ’²å±¤è²¢ç»

PWC ä½œç‚ºå…­é‘°ç³»çµ±çš„ç¬¬äº”å€‹çµ„ä»¶ï¼Œå°ˆé–€è² è²¬**æ‹“æ’²å±¤é¢**çš„æ„è­˜ç‹€æ…‹ç›£æ¸¬ï¼š

- **FELC**ï¼ˆèƒ½é‡å±¤ï¼‰â†’ è‡ªç”±èƒ½æ¥µé™ç’°
- **RFI**ï¼ˆå¹¾ä½•å±¤ï¼‰â†’ Ricci æ›²ç‡æµ
- **ECGP**ï¼ˆè¨Šæ¯å±¤ï¼‰â†’ å› æœæ»²æµ
- **PWC**ï¼ˆæ‹“æ’²å±¤ï¼‰â†’ ç›¸ä½ç’°æµ
- **å¾…çºŒ**ï¼ˆæ•´åˆå±¤ï¼‰â†’ ç¬¬å…­é‘°
### å¤šé‘°å”åŒæ©Ÿåˆ¶(æ¥ä¸‹é )

```python
# å¤šé‘°åŒæ­¥åˆ†æç¤ºä¾‹
def multi_key_analysis(data):
    # è¨ˆç®—å„é‘°æŒ‡æ¨™
    felc_score = compute_felc(data)
    rfi_score = compute_rfi(data)
    ecgp_score = compute_ecgp(data)
    pwc_score = compute_pwc(data)
    
    # è¨ˆç®—åŠ æ¬Šè·é›¢
    weights = [0.25, 0.25, 0.25, 0.25]  # ç­‰æ¬Šé‡
    zetas = [felc_score, rfi_score, ecgp_score, pwc_score]
    
    Dw_squared = sum(w * z**2 for w, z in zip(weights, zetas))
    Dw = np.sqrt(Dw_squared)
    
    # åˆ¤æ–·ç®¡é“ç‹€æ…‹
    in_manifold = Dw < 0.5  # é–¾å€¼ç¤ºä¾‹
    
    return {
        'Dw': Dw,
        'in_manifold': in_manifold,
        'individual_scores': dict(zip(['FELC', 'RFI', 'ECGP', 'PWC'], zetas))
    }
```

---
## ğŸ“ æœ¬ç¯€å°çµ

**æœ¬ç¯€å°‡ç›¸ä½æ‹“æ’²ç’°æµæ­£å¼å®šå¼ç‚ºæ»‘å‹•åµŒå…¥é»é›²çš„ Betti$_1$ å‹•æ…‹ï¼Œä¸¦æå‡º PWC åˆ¤æº– $C_{\text{PWC}}$ èˆ‡ç„¡é‡ç¶±åŒ– $\zeta_5$ï¼Œæ·»è£œ CTM ç®¡é“è·é›¢ $D_w$ çš„æ‹“æ’²å±¤ã€‚**
### ğŸ¯ é—œéµæˆå°±
- âœ… **æ‹“æ’²ç†è«–**ï¼šå»ºç«‹äº†ç›¸ä½ç©ºé–“æ‹“æ’²åˆ†æçš„æ•¸å­¸æ¡†æ¶
- âœ… **è¨ˆç®—æ–¹æ³•**ï¼šæä¾›äº†é«˜æ•ˆçš„ Î²â‚ è¨ˆç®—ç®—æ³•
- âœ… **åˆ¤æº–å‡½æ•¸**ï¼šè¨­è¨ˆäº†ç©©å¥çš„ PWC äºŒå€¼åˆ¤æº–
- âœ… **ç³»çµ±æ•´åˆ**ï¼šå¯¦ç¾äº†èˆ‡å…¶ä»–å››é‘°çš„ç„¡ç¸«è€¦åˆ
