---
title: "04-1_RFI Ricci æ›²ç‡è‡¨ç•Œæµ(ä¸Š)"
date: 2025-06-22
language: zh-TW
encoding: UTF-8
---
# 04-1 RFIï¼šRicci æ›²ç‡è‡¨ç•Œæµï¼ˆä¸Šï¼‰

## ğŸ¯ Purpose â€” ç†è«–å‹•æ©Ÿèˆ‡æ–‡ç»

### æ ¸å¿ƒå‹•æ©Ÿ

1. **å¹¾ä½•â€”æ‹“æ’²æ©‹æ¨‘**
   - Ollivierâ€“Ricci æ›²ç‡ $\kappa_{ij}$ ç‚ºé›¢æ•£åœ–ä¸Šåº¦é‡å¹¾ä½•çš„è‡ªç„¶æ¨å»£
   - èƒ½åŒæ™‚æ•æ‰ *å±€éƒ¨è€¦åˆå¼·åº¦* èˆ‡ *å…¨åŸŸè³‡è¨Šæµå»£åº¦*
   - åœ¨å°ä¸–ç•Œç¶²è·¯ä¸­ï¼Œ$\bar{\kappa} \approx 0$ å°æ‡‰è‡¨ç•Œç©¿é€šé–¾å€¼

2. **è…¦ç¶²è·¯éŸŒæ€§æŒ‡æ¨™**
   - é«˜æ­£æ›²ç‡é‚Šç·£åŒ–è¨Šè™Ÿå°å™ªè¡°æ¸›
   - é«˜è² æ›²ç‡å‰‡å¢ä¿ƒçˆ†ç™¼å‚³æ’­
   - fMRI èˆ‡ MEG ç ”ç©¶æŒ‡å‡ºï¼š
     - æ¸…é†’è…¦çš„å¹³å‡æ›²ç‡ $\bar{\kappa}$ æ¥è¿‘é›¶ä½†å¸¶ç´°å¾®å‹•æ…‹èµ·ä¼
     - æ˜è¿·èˆ‡æ·±éº»é†‰ä½¿ $\bar{\kappa} \ll 0$
     - é¡ç™²ç™‡çˆ†ç™¼å‰‡çŸ­æš«ç¿»æˆ $\bar{\kappa} > 0$

3. **è‡¨ç•Œæµæ€è·¯**
   - æŠŠ $P(t)$ï¼ˆèƒ½é‡è€—åŠŸï¼‰è¦–ç‚ºã€Œå½æ›²æºã€
   - è…¦ç¶²æ ¼æœƒé€æ­¥ç¶“é›¢æ•£ Ricci flow $\partial_t g_{ij} = -2\,\kappa_{ij}$ é€¼è¿‘è‡¨ç•Œå¹³å¦é¢ $(\bar{\kappa} \to 0)$
   - å½¢æˆå¿«é€Ÿå‹•æ…‹æŸ”åŒ–æ©Ÿåˆ¶

4. **ç ”ç©¶ç¼ºå£**
   - å¤šæ•¸å·¥ä½œåªéœæ…‹æ¯”è¼ƒæ¸…é†’ vs. éº»é†‰çš„éœæ…‹æ›²ç‡åˆ†å¸ƒ
   - *æ™‚é–“æ¼”åŒ–* èˆ‡ *è‡¨ç•Œæµå‹•* çš„é‡åŒ–æŒ‡æ¨™ä»˜ä¹‹é—•å¦‚
   - å› æ­¤æå‡ºã€ŒRicci æ›²ç‡è‡¨ç•Œæµï¼ˆRFIï¼‰ã€ä½œç‚ºå…­é‘°ä¸­çš„ç¬¬äºŒé‘° $\Psi$ ä¹‹ **å¹¾ä½•åˆ¤æº–**

---
### ğŸ”‘ æ ¸å¿ƒå‡èªª

> **åªæœ‰ç•¶è…¦ç¶²è·¯çš„å¹³å‡ Ricci æ›²ç‡ $\bar{\kappa}(t)$ ç¶­æŒåœ¨è‡¨ç•Œçª—æ ¼ $[\kappa_{\min}, \kappa_{\max}]$ å…§ï¼ˆ$C_{\text{RFI}}=1$ï¼‰ï¼Œç³»çµ±æ‰èƒ½ä¿æŒæœ€ä½³çš„è³‡è¨Šå‚³è¼¸æ•ˆç‡èˆ‡æŠ—å™ªéŸŒæ€§ï¼Œå°æ‡‰æ„è­˜çš„å¹¾ä½•åŸºç¤ã€‚**

---
## ğŸ“ æ•¸å­¸å®šå¼èˆ‡æ ¸å¿ƒæ–¹ç¨‹

### Ollivier-Ricci æ›²ç‡

å°æ–¼è…¦ç¶²è·¯åœ– $G = (V, E)$ï¼Œé‚Š $(i,j) \in E$ çš„ Ollivier-Ricci æ›²ç‡å®šç¾©ç‚ºï¼š

$$
\kappa_{ij} = 1 - \frac{W_1(\mu_i, \mu_j)}{d_{ij}}
$$

å…¶ä¸­ï¼š
- $W_1(\mu_i, \mu_j)$ï¼šç¯€é» $i$ å’Œ $j$ çš„é„°åŸŸåˆ†å¸ƒé–“çš„ Wasserstein-1 è·é›¢  
- $d_{ij}$ï¼šç¯€é»é–“çš„æ¸¬åœ°è·é›¢  
- $\mu_i$ï¼šç¯€é» $i$ çš„é„°åŸŸæ¦‚ç‡åˆ†å¸ƒ  

### å¹³å‡æ›²ç‡èˆ‡è‡¨ç•Œæµ

å®šç¾©ç¶²è·¯çš„å¹³å‡ Ricci æ›²ç‡ï¼š

$$
\bar{\kappa}(t) = \frac{1}{|E|} \sum_{(i,j) \in E} w_{ij}(t) \cdot \kappa_{ij}(t)
$$

å…¶ä¸­ $w_{ij}(t)$ ç‚ºæ™‚è®Šé‚Šæ¬Šé‡ï¼ˆå¦‚åŠŸèƒ½é€£æ¥å¼·åº¦ï¼‰ã€‚

### é›¢æ•£ Ricci æµæ¼”åŒ–

è…¦ç¶²è·¯çš„å¹¾ä½•æ¼”åŒ–éµå¾ªé›¢æ•£ Ricci æµæ–¹ç¨‹ï¼š

$$
\frac{\partial g_{ij}}{\partial t} = -2\kappa_{ij}(t) + \eta_{ij}(t)
$$

å…¶ä¸­ï¼š
- $g_{ij}(t)$ï¼šæ™‚è®Šåº¦é‡å¼µé‡  
- $\eta_{ij}(t)$ï¼šå¤–éƒ¨é©…å‹•é …ï¼ˆå¦‚æ„Ÿè¦ºè¼¸å…¥ã€èªçŸ¥è² è·ï¼‰  

### RFI åˆ¤æº–å‡½æ•¸

å®šç¾© Ricci æ›²ç‡è‡¨ç•Œæµåˆ¤æº–ï¼š

$$
C_{\text{RFI}} = \begin{cases}
1 & \text{if } \kappa_{\min} \leq \bar{\kappa}(t) \leq \kappa_{\max} \text{ for all } t \in [T-\tau, T] \\
0 & \text{otherwise}
\end{cases}
$$

å…¶ä¸­ï¼š
- $\kappa_{\min}, \kappa_{\max}$ï¼šè‡¨ç•Œçª—æ ¼é‚Šç•Œ  
- $\tau$ï¼šè§€æ¸¬æ™‚é–“çª—  

### æ¨™æº–åŒ–åº§æ¨™

å°‡ RFI ç‹€æ…‹æ¨™æº–åŒ–ç‚ºå…­é‘°æ¡†æ¶ä¸­çš„ç¬¬äºŒç¶­ï¼š

$$
\zeta_2 = \frac{\bar{\kappa} - \kappa^\ast}{\varepsilon_2}
$$

å…¶ä¸­ï¼š
- $\kappa^\ast = \frac{\kappa_{\min} + \kappa_{\max}}{2}$ï¼šè‡¨ç•Œçª—æ ¼ä¸­å¿ƒ  
- $\varepsilon_2 = \frac{\kappa_{\max} - \kappa_{\min}}{2}$ï¼šæ¨™æº–åŒ–å°ºåº¦åƒæ•¸  


---
## ğŸ”¬ å¯¦ä½œç´°ç¯€èˆ‡è¨ˆç®—æµç¨‹

### æ¼”ç®—æ³•æ­¥é©Ÿ(æ¥ä¸‹é )

```python
def compute_RFI_criterion(connectivity_matrix, kappa_min=-0.1, kappa_max=0.1, tau=100):
    """
    è¨ˆç®— Ricci æ›²ç‡è‡¨ç•Œæµåˆ¤æº–
    
    Parameters:
    -----------
    connectivity_matrix : array
        åŠŸèƒ½é€£æ¥çŸ©é™£æ™‚é–“åºåˆ— (time, nodes, nodes)
    kappa_min, kappa_max : float
        è‡¨ç•Œçª—æ ¼é‚Šç•Œ
    tau : int
        è§€æ¸¬æ™‚é–“çª—é•·åº¦
    
    Returns:
    --------
    C_RFI : int
        RFI åˆ¤æº– (0 æˆ– 1)
    zeta2 : float
        æ¨™æº–åŒ–åº§æ¨™
    """
    import networkx as nx
    from GraphRicciCurvature.OllivierRicci import OllivierRicci
    
    kappa_series = []
    
    for t in range(connectivity_matrix.shape[0]):
        # æ§‹å»ºç¶²è·¯åœ–
        G = nx.from_numpy_array(connectivity_matrix[t])
        
        # è¨ˆç®— Ollivier-Ricci æ›²ç‡
        orc = OllivierRicci(G, alpha=0.5, verbose="ERROR")
        orc.compute_ricci_curvature()
        
        # è¨ˆç®—å¹³å‡æ›²ç‡
        kappa_values = [orc.G[u][v]['ricciCurvature'] for u, v in orc.G.edges()]
        kappa_mean = np.mean(kappa_values)
        kappa_series.append(kappa_mean)
    
    kappa_series = np.array(kappa_series)
    
    # æª¢æŸ¥æœ€è¿‘ tau å€‹æ™‚é–“é»
    recent_kappa = kappa_series[-tau:]
    
    # åˆ¤æ–·æ˜¯å¦åœ¨è‡¨ç•Œçª—æ ¼å…§
    in_range = np.all((recent_kappa >= kappa_min) & (recent_kappa <= kappa_max))
    
    C_RFI = 1 if in_range else 0
    
    # è¨ˆç®—æ¨™æº–åŒ–åº§æ¨™
    kappa_ast = (kappa_min + kappa_max) / 2
    epsilon2 = (kappa_max - kappa_min) / 2
    zeta2 = (np.mean(recent_kappa) - kappa_ast) / epsilon2
    
    return C_RFI, zeta2
```

### åƒæ•¸è¨­å®šæŒ‡å¼•
| åƒæ•¸             | å»ºè­°ç¯„åœ     | ç‰©ç†æ„ç¾©                       |
|------------------|--------------|--------------------------------|
| $\kappa_{\min}$  | -0.15        | è² æ›²ç‡ä¸‹ç•Œï¼Œé¿å…éåº¦ç™¼æ•£       |
| $\kappa_{\max}$  | +0.15        | æ­£æ›²ç‡ä¸Šç•Œï¼Œé¿å…éåº¦æ”¶æ–‚       |
| $\tau$           | 50â€“200 ms    | å°æ‡‰ç¥ç¶“æŒ¯ç›ªé€±æœŸ               |
| $\alpha$         | 0.3â€“0.7      | Ollivier åƒæ•¸ï¼Œæ§åˆ¶å±€éƒ¨æ€§      |

---
## ğŸ“Š èˆ‡ CTM ç®¡é“çš„è€¦åˆ

### åŠ æ¬Šè·é›¢è²¢ç»

åœ¨ CTM æ¡†æ¶ä¸­ï¼ŒRFI é€šéæ¨™æº–åŒ–åº§æ¨™ $\zeta_2$ è²¢ç»æ–¼ç¸½é«”ç®¡é“è·é›¢ï¼š

$$
D_w^2 = w_1\,\zeta_1^{2} + w_2\,\zeta_2^{2} + \sum_{i=3}^{6} w_i\,\zeta_i^{2}
$$

### å¹¾ä½•â€”å‹•åŠ›å­¸è€¦åˆ

RFI èˆ‡ FELC çš„è€¦åˆé—œä¿‚ï¼š

$$
\frac{d\bar{\kappa}}{dt} = -\gamma \cdot |\zeta_1|^2 + \beta \cdot \nabla^2 \bar{\kappa}
$$

å…¶ä¸­ï¼š
- $\gamma$ï¼šFELCâ€“RFI è€¦åˆå¼·åº¦  
- $\beta$ï¼šç©ºé–“æ“´æ•£ä¿‚æ•¸  

ä¸€æ—¦ $C_{\text{RFI}} = 0$ï¼Œ$|\zeta_2| \gg 1$ æ‹‰é«˜ $D_w$ï¼Œèˆ‡ FELC å´©æ½°äº‹ä»¶å¸¸å‘ˆå› æœå…ˆå¾Œã€‚

---

## ğŸ“ å°çµ

æœ¬ç¯€æŠŠ Ricci æ›²ç‡åµŒå…¥è‡¨ç•Œæµè¦–è§’ï¼Œçµ¦å‡º RFI åˆ¤æº– $C_{\text{RFI}}$ èˆ‡ç„¡é‡ç¶±åŒ– $\zeta_2$ï¼Œç‚º CTM åŠ æ¬Šè·é›¢æä¾›ç¬¬äºŒå€‹ï¼ˆå¹¾ä½•å±¤ï¼‰æ”¯æŸ±ã€‚  
ä¸‹åŠç« å°‡ç¤ºç¯„ Bruno et al. MEG è³‡æ–™é›†é‡åˆ†æï¼Œå±•ç¤º $\bar{\kappa}$ æ–¼æ¸…é†’èˆ‡ç•°ä¸™é…šéº»é†‰çš„æ™‚é–“æ¼”åŒ–ã€‚

**é—œéµæˆæœï¼š**
- âœ… å»ºç«‹äº†è…¦ç¶²è·¯å¹¾ä½•çš„å‹•æ…‹åˆ¤æº–  
- âœ… æ•´åˆ Ricci æµç†è«–èˆ‡æ„è­˜ç ”ç©¶  
- âœ… æä¾›äº†å¯è¨ˆç®—çš„è‡¨ç•Œçª—æ ¼æŒ‡æ¨™  
- âœ… èˆ‡ FELC å½¢æˆå‹•åŠ›å­¸â€”å¹¾ä½•è€¦åˆ  


---

**ä¸‹ä¸€ç« é å‘Šï¼š** 04-2 RFIï¼šRicci æ›²ç‡è‡¨ç•Œæµï¼ˆä¸‹ï¼‰å°‡å±•ç¤ºå¯¦é©—é©—è­‰èˆ‡è‡¨åºŠæ‡‰ç”¨æ¡ˆä¾‹ã€‚